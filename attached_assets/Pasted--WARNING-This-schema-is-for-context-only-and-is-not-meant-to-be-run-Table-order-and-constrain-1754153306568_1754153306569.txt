-- WARNING: This schema is for context only and is not meant to be run.
-- Table order and constraints may not be valid for execution.

CREATE TABLE public.companies (
  id integer NOT NULL DEFAULT nextval('companies_id_seq'::regclass),
  name character varying NOT NULL,
  cif character varying,
  trade_registry character varying,
  address text,
  commission_rate numeric DEFAULT 0.04,
  tenant_id character varying DEFAULT 'main'::character varying,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT companies_pkey PRIMARY KEY (id)
);
CREATE TABLE public.company_balances (
  id integer NOT NULL DEFAULT nextval('company_balances_id_seq'::regclass),
  company_id integer,
  week_label character varying NOT NULL,
  total_invoiced numeric NOT NULL DEFAULT 0,
  total_paid numeric NOT NULL DEFAULT 0,
  outstanding_balance numeric NOT NULL DEFAULT 0,
  status character varying DEFAULT 'pending'::character varying,
  tenant_id character varying DEFAULT 'main'::character varying,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT company_balances_pkey PRIMARY KEY (id),
  CONSTRAINT company_balances_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id)
);
CREATE TABLE public.drivers (
  id integer NOT NULL DEFAULT nextval('drivers_id_seq'::regclass),
  name character varying NOT NULL,
  company_id integer,
  vrid character varying,
  email character varying,
  tenant_id character varying DEFAULT 'main'::character varying,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT drivers_pkey PRIMARY KEY (id),
  CONSTRAINT drivers_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id)
);
CREATE TABLE public.historical_trips (
  id integer NOT NULL DEFAULT nextval('historical_trips_id_seq'::regclass),
  vrid character varying,
  driver_name character varying,
  company_name character varying,
  week_label character varying,
  amount numeric,
  tenant_id character varying DEFAULT 'main'::character varying,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT historical_trips_pkey PRIMARY KEY (id)
);
CREATE TABLE public.order_sequences (
  id integer NOT NULL DEFAULT nextval('order_sequences_id_seq'::regclass),
  last_order_number integer DEFAULT 1553,
  tenant_id character varying DEFAULT 'main'::character varying,
  updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT order_sequences_pkey PRIMARY KEY (id)
);
CREATE TABLE public.payment_history (
  id integer NOT NULL DEFAULT nextval('payment_history_id_seq'::regclass),
  company_id integer,
  week_label character varying NOT NULL,
  amount numeric NOT NULL,
  payment_date timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  notes text,
  tenant_id character varying DEFAULT 'main'::character varying,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT payment_history_pkey PRIMARY KEY (id),
  CONSTRAINT payment_history_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id)
);
CREATE TABLE public.payments (
  id integer NOT NULL DEFAULT nextval('payments_id_seq'::regclass),
  company_id integer,
  week_label character varying NOT NULL,
  amount numeric NOT NULL,
  commission numeric DEFAULT 0,
  status character varying DEFAULT 'pending'::character varying,
  tenant_id character varying DEFAULT 'main'::character varying,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT payments_pkey PRIMARY KEY (id),
  CONSTRAINT payments_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id)
);
CREATE TABLE public.transport_orders (
  id integer NOT NULL DEFAULT nextval('transport_orders_id_seq'::regclass),
  order_number integer NOT NULL,
  company_id integer,
  week_label character varying NOT NULL,
  total_amount numeric NOT NULL,
  tenant_id character varying DEFAULT 'main'::character varying,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT transport_orders_pkey PRIMARY KEY (id),
  CONSTRAINT transport_orders_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id)
);
CREATE TABLE public.users (
  id integer NOT NULL DEFAULT nextval('users_id_seq'::regclass),
  username character varying NOT NULL UNIQUE,
  email character varying NOT NULL UNIQUE,
  password_hash character varying NOT NULL,
  role character varying DEFAULT 'subscriber'::character varying,
  tenant_id character varying,
  subscription_status character varying DEFAULT 'active'::character varying,
  subscription_plan character varying DEFAULT 'transport_pro'::character varying,
  subscription_start_date timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT users_pkey PRIMARY KEY (id)
);
CREATE TABLE public.weekly_processing (
  id integer NOT NULL DEFAULT nextval('weekly_processing_id_seq'::regclass),
  week_label character varying NOT NULL,
  processing_date timestamp without time zone NOT NULL,
  total_amount numeric DEFAULT 0,
  total_trips integer DEFAULT 0,
  status character varying DEFAULT 'pending'::character varying,
  tenant_id character varying DEFAULT 'main'::character varying,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT weekly_processing_pkey PRIMARY KEY (id)
);